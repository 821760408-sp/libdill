<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>libdill</title>
  <link rel="stylesheet" type="text/css" href="http://libdill.org/main.css">
</head>
<body>

<h1>libdill: Structured Concurrency for C</h1>

<ul id='toplist'>
<li><a href="http://libdill.org/index.html">Home</a></li>
<li><a href="http://libdill.org/download.html">Download</a></li>
<li><a href="http://libdill.org/documentation.html">Documentation</a></li>
<li><a href="http://libdill.org/tutorial.html">Tutorials</a></li>
</ul>
<h1 id="name">NAME</h1>
<p>bundle_go - start a coroutine within a specified bundle</p>
<h1 id="synopsis">SYNOPSIS</h1>
<p><strong>#include &lt;libdill.h&gt;</strong></p>
<p><strong>int bundle_go(int </strong><em>bndl</em><strong>, </strong><em>expression</em><strong>);</strong></p>
<h1 id="description">DESCRIPTION</h1>
<p>Launches a coroutine that executes the function invocation passed as the <em>expression</em> argument. The coroutine is executed concurrently, and its lifetime may exceed the lifetime of the caller coroutine. The return value of the coroutine, if any, is discarded and cannot be retrieved by the caller.</p>
<p>The coroutine will run inside of bundle specified by <em>bndl</em> argument and it will be canceled when the bundle is closed.</p>
<p>Any function to be invoked with <strong>bundle_go()</strong> must be declared with the <strong>coroutine</strong> specifier.</p>
<p><em>WARNING</em>: Coroutines will most likely work even without the <strong>coroutine</strong> specifier. However, they may fail in random non-deterministic ways, depending on the code in question and the particular combination of a compiler and optimization level. Additionally, arguments to a coroutine must not be function calls. If they are, the program may fail non-deterministically. If you need to pass a result of a computation to a coroutine, do the computation first, and then pass the result as an argument. Instead of:</p>
<pre class="sourceCode c"><code class="sourceCode c">bundle_go(bndl, bar(foo(a)));</code></pre>
<p>Do this:</p>
<pre class="sourceCode c"><code class="sourceCode c"><span class="dt">int</span> a = foo();
bundle_go(bndl, bar(a));</code></pre>
<h1 id="return-value">RETURN VALUE</h1>
<p>Returns zero in the case of success. In the case of an error, it returns -1 and sets <em>errno</em> to one of the values below.</p>
<h1 id="errors">ERRORS</h1>
<ul>
<li><strong>ECANCELED</strong>: Current coroutine is in the process of shutting down.<br /></li>
<li><strong>ENOMEM</strong>: Not enough memory to allocate the coroutine stack.</li>
</ul>
<h1 id="example">EXAMPLE</h1>
<pre class="sourceCode c"><code class="sourceCode c"><span class="dt">int</span> b = bundle();
bundle_go(b, worker());
bundle_go(b, worker());
bundle_go(b, worker());
msleep(now() + <span class="dv">1000</span>);
<span class="co">/* Cancel any workers that are still running. */</span>
hclose(b);</code></pre>
</body>
