<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>libdill</title>
  <link rel="stylesheet" type="text/css" href="http://libdill.org/main.css">
</head>
<body>

<h1>libdill: Structured Concurrency for C</h1>

<ul id='toplist'>
<li><a href="http://libdill.org/index.html">Home</a></li>
<li><a href="http://libdill.org/download.html">Download</a></li>
<li><a href="http://libdill.org/documentation.html">Documentation</a></li>
<li><a href="http://libdill.org/tutorial.html">Tutorials</a></li>
</ul>
<h1 id="documentation">Documentation</h1>
<p><a href="build_options.html">Build options</a><br /><a href="compatibility.html">Compatibility</a><br /><a href="threads.html">Threads</a></p>
<ul>
<li><a href="http://libdill.org/man/brecv.html">brecv</a><br /></li>
<li><a href="http://libdill.org/man/bsend.html">bsend</a><br /></li>
<li><a href="http://libdill.org/man/chmake.html">chmake</a><br /></li>
<li><a href="http://libdill.org/man/chmake_mem.html">chmake_mem</a><br /></li>
<li><a href="http://libdill.org/man/choose.html">choose</a><br /></li>
<li><a href="http://libdill.org/man/chrecv.html">chrecv</a><br /></li>
<li><a href="http://libdill.org/man/chsend.html">chsend</a><br /></li>
<li><a href="http://libdill.org/man/crlf_attach.html">crlf_attach</a><br /></li>
<li><a href="http://libdill.org/man/crlf_detach.html">crlf_detach</a><br /></li>
<li><a href="http://libdill.org/man/fdclean.html">fdclean</a><br /></li>
<li><a href="http://libdill.org/man/fdin.html">fdin</a><br /></li>
<li><a href="http://libdill.org/man/fdout.html">fdout</a><br /></li>
<li><a href="http://libdill.org/man/go.html">go</a><br /></li>
<li><a href="http://libdill.org/man/go_mem.html">go_mem</a><br /></li>
<li><a href="http://libdill.org/man/hclose.html">hclose</a><br /></li>
<li><a href="http://libdill.org/man/hdone.html">hdone</a><br /></li>
<li><a href="http://libdill.org/man/hdup.html">hdup</a><br /></li>
<li><a href="http://libdill.org/man/hmake.html">hmake</a><br /></li>
<li><a href="http://libdill.org/man/hquery.html">hquery</a><br /></li>
<li><a href="http://libdill.org/man/ipaddr_family.html">ipaddr_family</a><br /></li>
<li><a href="http://libdill.org/man/ipaddr_len.html">ipaddr_len</a><br /></li>
<li><a href="http://libdill.org/man/ipaddr_local.html">ipaddr_local</a><br /></li>
<li><a href="http://libdill.org/man/ipaddr_port.html">ipaddr_port</a><br /></li>
<li><a href="http://libdill.org/man/ipaddr_remote.html">ipaddr_remote</a><br /></li>
<li><a href="http://libdill.org/man/ipaddr_setport.html">ipaddr_setport</a><br /></li>
<li><a href="http://libdill.org/man/ipaddr_sockaddr.html">ipaddr_sockaddr</a><br /></li>
<li><a href="http://libdill.org/man/ipaddr_str.html">ipaddr_str</a><br /></li>
<li><a href="http://libdill.org/man/ipc_accept.html">ipc_accept</a><br /></li>
<li><a href="http://libdill.org/man/ipc_close.html">ipc_close</a><br /></li>
<li><a href="http://libdill.org/man/ipc_connect.html">ipc_connect</a><br /></li>
<li><a href="http://libdill.org/man/ipc_listen.html">ipc_listen</a><br /></li>
<li><a href="http://libdill.org/man/ipc_pair.html">ipc_pair</a><br /></li>
<li><a href="http://libdill.org/man/mrecv.html">mrecv</a><br /></li>
<li><a href="http://libdill.org/man/msend.html">msend</a><br /></li>
<li><a href="http://libdill.org/man/msleep.html">msleep</a><br /></li>
<li><a href="http://libdill.org/man/now.html">now</a><br /></li>
<li><a href="http://libdill.org/man/pfx_attach.html">pfx_attach</a><br /></li>
<li><a href="http://libdill.org/man/pfx_detach.html">pfx_detach</a><br /></li>
<li><a href="http://libdill.org/man/tcp_accept.html">tcp_accept</a><br /></li>
<li><a href="http://libdill.org/man/tcp_close.html">tcp_close</a><br /></li>
<li><a href="http://libdill.org/man/tcp_connect.html">tcp_connect</a><br /></li>
<li><a href="http://libdill.org/man/tcp_listen.html">tcp_listen</a><br /></li>
<li><a href="http://libdill.org/man/udp_open.html">udp_open</a><br /></li>
<li><a href="http://libdill.org/man/udp_recv.html">udp_recv</a><br /></li>
<li><a href="http://libdill.org/man/udp_send.html">udp_send</a><br /></li>
<li><a href="http://libdill.org/man/yield.html">yield</a></li>
</ul>
<h2 id="faq-how-can-i-report-a-bug">FAQ: How can I report a bug?</h2>
<p>Report a bug here:</p>
<p><a href="https://github.com/sustrik/libdill/issues">https://github.com/sustrik/libdill/issues</a></p>
<h2 id="faq-whats-structured-concurrency">FAQ: What's structured concurrency?</h2>
<p>Check this short introductory <a href="structured-concurrency.html">article</a> about structured concurrency.</p>
<h2 id="faq-whats-libdills-performance">FAQ: What's libdill's performance?</h2>
<p>The best way to find out is to check for yourself. You will find some small performance benchmarks in the <code>perf</code> subdirectory.</p>
<p>Generally speaking, though, libdill's concurrency primitives are only a bit slower than basic C flow control statements. A context switch has been seen to execute in as little as 6 ns, with coroutine creation taking 26 ns. Passing a message through a channel takes about 40 ns.</p>
<h2 id="faq-how-does-libdills-concurrency-differ-from-gos-concurrency">FAQ: How does libdill's concurrency differ from Go's concurrency?</h2>
<ol>
<li>No interaction between threads. Each thread is treated as a separate process.<br /></li>
<li>Channels are always unbuffered.<br /></li>
<li><code>choose</code>, unlike <code>select</code>, is deterministic. If multiple clauses can be executed, the clause closest to the beginning of the pollset wins.<br /></li>
<li><code>chdone</code> signals the closing of a channel to both senders and receivers.<br /></li>
<li>Coroutines can be canceled.</li>
</ol>
<h2 id="faq-how-does-libdill-differ-from-libmill">FAQ: How does libdill differ from libmill?</h2>
<p><code>libmill</code> was a project that aimed to copy Go's concurrency model to C 1:1 without introducing any innovations or experiments. The project is finished now. It will be maintained but won't change in the future.</p>
<p><code>libdill</code> is a follow-up project that experiments with structured concurrency and diverges from the Go model.</p>
<p>Technically, these are the differences:</p>
<ol>
<li>Libdill is idiomatic C. Whereas libmill takes Go's concurrency API and implements it in an almost identical manner in C, libdill tries to provide the same functionality via a more C-like and POSIX-like API. For example, <code>choose</code> is a function in libdill rather than a language construct, or Go's panic is replaced with error returns.<br /></li>
<li>Coroutines can be canceled. This creates a foundation for &quot;structured concurrency&quot;.<br /></li>
<li><code>chdone</code> causes blocked <code>recv</code> on the channel to return the <code>EPIPE</code> error rather than a value.<br /></li>
<li><code>chdone</code> will signal both the senders and the receivers of a channel. This allows for scenarios such as multiple senders and a single receiver communicating via a single channel. The receiver can use <code>chdone</code> to let the senders know that it's terminating.<br /></li>
<li>libmill's <code>fdwait</code> was replaced by <code>fdin</code> and <code>fdout</code>. The idea is that if we want data to flow through the connection in both directions in parallel, we should use two coroutines rather than one.</li>
</ol>
<h2 id="faq-how-can-i-access-the-source-code">FAQ: How can I access the source code?</h2>
<p>To clone the repository, run:</p>
<pre><code>$ git clone https://github.com/sustrik/libdill.git</code></pre>
<p>To build from the source (you'll need automake and libtool), run:</p>
<pre><code>$ ./autogen.sh
$ ./configure
$ make
$ make check
$ sudo make install</code></pre>
<p>For easy debugging, use the following configure options:</p>
<pre><code>$ ./configure --disable-shared --enable-debug --enable-valgrind</code></pre>
<p>The above will turn optimization off, generate debug symbols, and link all the tests with the static version of the library. The second option will cause executables in the <code>tests</code> subdirectory to be actual debuggable binaries rather that wrapper shell scripts. The last option instructs valgrind about where the coroutine stacks are located, thereby preventing valgrind from generating spurious warnings.</p>
<h2 id="faq-is-continuous-integration-available-for-libdill">FAQ: Is continuous integration available for libdill?</h2>
<iframe width="100%" height="20" frameBorder="0"
src="https://api.travis-ci.org/sustrik/libdill.svg?branch=master">
</iframe>


<p>Travis: <a href="https://travis-ci.org/sustrik/libdill">https://travis-ci.org/sustrik/libdill</a></p>
<h2 id="faq-how-can-i-contribute">FAQ: How can I contribute?</h2>
<p>To contribute to libdill, create a GitHub pull request. You have to state that your patch is submitted under the MIT/X11 license, so that it can be incorporated into the mainline codebase without licensing issues.</p>
<p>If you make a substantial contribution to a file, add your copyright to the file header. Irrespective of whether you do so or not, your name will be added to the AUTHORS file to indicate you own copyright to part of the codebase.</p>
<h2 id="faq-how-can-i-see-coverage-report-for-the-tests">FAQ: How can I see coverage report for the tests?</h2>
<pre><code>$ ./configure --enable-gcov
$ make clean
$ make check
$ lcov -t &quot;libdill&quot; -o libdill.info -c -d .
$ genhtml -o lcov libdill.info</code></pre>
<p>After doing the steps above open <code>lcov/index.html</code> in your browser.</p>
<h2 id="faq-what-is-the-release-process">FAQ: What is the release process?</h2>
<p>These instructions are intended for project maintainers:</p>
<ul>
<li>Run <code>make distcheck</code> to check whether the packaging process still works.<br /></li>
<li>Bump the ABI version appropriately (see here: <a href="http://250bpm.com/blog:41">http://250bpm.com/blog:41</a>).<br /></li>
<li>Commit and push your commits back to the master branch on GitHub.<br /></li>
<li>Tag the new version and push the tag to GitHub (e.g. <code>git tag -a 0.3-beta; git push origin 0.3-beta</code>).<br /></li>
<li>Clone a clean repo from GitHub.<br /></li>
<li>Build the package (<code>./autogen.sh; ./configure; make distcheck</code>).<br /></li>
<li>Add the package to the <code>gh-pages</code> branch.<br /></li>
<li>Adjust <code>download.md</code> in <code>gh-pages</code> branch.<br /></li>
<li>Regenerate the documentation using <code>./gendocs.sh &lt;version-number&gt;</code>.<br /></li>
<li>Commit and push to <code>gh-pages</code>.<br /></li>
<li>Announce the release on twitter, etc.</li>
</ul>
</body>
